+function(a){a.ajax({type:"GET",url:"ajax.php?action=area_json",cache:true,dataType:"json",async:false,success:function(b){a.rawCitiesData=b}})}($);+function(f){var h;var d=f.rawCitiesData;var g=function(l){var j=[];for(var k=0;k<l.length;k++){var m=l[k];if(/^请选择|市辖区/.test(m.name)){continue}j.push(m)}if(j.length){return j}return[]};var e=function(i){if(!i.sub){return[{name:"",code:i.code}]}return g(i.sub)};var c=function(k){for(var j=0;j<d.length;j++){if(d[j].code===k||d[j].name===k){return e(d[j])}}return[]};var b=function(m,n){for(var l=0;l<d.length;l++){if(d[l].code===m||d[l].name===m){for(var k=0;k<d[l].sub.length;k++){if(d[l].sub[k].code===n||d[l].sub[k].name===n){return e(d[l].sub[k])}}}}};var a=function(l){var j=d[0],m,k;var i=l.split(" ");d.map(function(n){if(n.name===i[0]){j=n}});j.sub.map(function(n){if(n.name===i[1]){m=n}});if(i[2]){console.log(i[2]);m.sub.map(function(n){if(n.name===i[2]){k=n}})}if(k){return[j.code,m.code,k.code]}return[j.code,m.code]};f.fn.cityPicker=function(i){i=f.extend({},h,i);return this.each(function(){var v=this;var o=f(v).parent().find("input[name='post[areaid]']");var j=d.map(function(p){return p.name});var k=d.map(function(p){return p.code});var s=e(d[0]);var l=s.map(function(p){return p.name});var m=s.map(function(p){return p.code});var A=e(d[0].sub[0]);var y=A.map(function(p){return p.name});var z=A.map(function(p){return p.code});var u=j[0];var r=l[0];var q=y[0];var t=[{displayValues:j,values:k,cssClass:"col-province"},{displayValues:l,values:m,cssClass:"col-city"}];if(i.showDistrict){t.push({values:z,displayValues:y,cssClass:"col-district"})}var B={cssClass:"city-picker",rotateEffect:false,formatValue:function(F,D,E){return E.join(" ")},onChange:function(H,J,p){var D=H.cols[0].displayValue;var K;if(D!==u){var I=c(D);K=I[0].name;var E=b(D,K);H.cols[1].replaceValues(I.map(function(L){return L.code}),I.map(function(L){return L.name}));if(i.showDistrict){H.cols[2].replaceValues(E.map(function(L){return L.code}),E.map(function(L){return L.name}))}u=D;r=K;H.updateValue();return false}else{if(i.showDistrict){K=H.cols[1].displayValue;if(K!==r){var F=b(D,K);H.cols[2].replaceValues(F.map(function(L){return L.code}),F.map(function(L){return L.name}));r=K;H.updateValue();return false}}}var G=(J[J.length-1]?J.length-1:J.length-2);f(v).attr("data-code",J[G]);f(v).attr("data-codes",J.join(","));o.val(f(v).attr("data-code"));if(i.onChange){i.onChange.call(v,H,J,p)}},cols:t};if(!this){return}var x=f.extend({},i,B);var C=f(this).val();if(!C){C="北京 北京"}u=C.split(" ")[0];r=C.split(" ")[1];q=C.split(" ")[2];if(C){x.value=a(C);if(x.value[0]){var n=c(x.value[0]);x.cols[1].values=n.map(function(p){return p.code});x.cols[1].displayValues=n.map(function(p){return p.name})}if(x.value[1]){if(i.showDistrict){var w=b(x.value[0],x.value[1]);x.cols[2].values=w.map(function(p){return p.code});x.cols[2].displayValues=w.map(function(p){return p.name})}}else{if(i.showDistrict){var w=b(x.value[0],x.cols[1].values[0]);x.cols[2].values=w.map(function(p){return p.code});x.cols[2].displayValues=w.map(function(p){return p.name})}}}f(this).picker(x)})};h=f.fn.cityPicker.prototype.defaults={showDistrict:true}}($);