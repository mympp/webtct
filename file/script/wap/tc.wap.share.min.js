var shareWrapInit=function(){$("body").append('<div id="sharePopup" class="weui-popup__container popup-bottom" style="display: none;"></div>')};var sharePopupHtml='<div class="weui-popup__overlay"></div><div class="weui-popup__modal"><div class="toolbar"><div class="toolbar-inner"><a href="javascript:;" class="picker-button close-popup">关闭</a><h1 class="title">分享到</h1></div></div><div class="modal-content share-modal-content"><div class="weui-grids"><a href="javascript:;" class="weui-grid share-wechat"><i class="iconfont icon-weixin"></i><p class="weui-grid__label">微信</p></a><a href="javascript:;" class="weui-grid share-weibo"><i class="iconfont icon-weibo"></i><p class="weui-grid__label">新浪微博</p></a><a href="javascript:;" class="weui-grid share-QQFriend"><i class="iconfont icon-QQ"></i><p class="weui-grid__label">QQ好友</p></a><a href="javascript:;" class="weui-grid share-QQZone"><i class="iconfont icon-qqkongjian"></i><p class="weui-grid__label">QQ空间</p></a><a href="javascript:;" class="weui-grid share-qrcode"><i class="iconfont icon-erweima1"></i><p class="weui-grid__label">二维码</p></a><a href="javascript:;" class="weui-grid share-copyLink" data-clipboard-action="copy" data-clipboard-text="'+globalConfig.link+'"><i class="iconfont icon-module-link"></i><p class="weui-grid__label">复制链接</p></a></div></div></div>';var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(t){var s,r,q,p,o,n,m,l="",k=0;for(t=Base64._utf8_encode(t);k<t.length;){s=t.charCodeAt(k++),r=t.charCodeAt(k++),q=t.charCodeAt(k++),p=s>>2,o=(3&s)<<4|r>>4,n=(15&r)<<2|q>>6,m=63&q,isNaN(r)?n=m=64:isNaN(q)&&(m=64),l=l+this._keyStr.charAt(p)+this._keyStr.charAt(o)+this._keyStr.charAt(n)+this._keyStr.charAt(m)}return l},decode:function(t){var s,r,q,p,o,n,m,l="",k=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<t.length;){p=this._keyStr.indexOf(t.charAt(k++)),o=this._keyStr.indexOf(t.charAt(k++)),n=this._keyStr.indexOf(t.charAt(k++)),m=this._keyStr.indexOf(t.charAt(k++)),s=p<<2|o>>4,r=(15&o)<<4|n>>2,q=(3&n)<<6|m,l+=String.fromCharCode(s),64!=n&&(l+=String.fromCharCode(r)),64!=m&&(l+=String.fromCharCode(q))}return l=Base64._utf8_decode(l)},_utf8_encode:function(f){f=f.replace(/\r\n/g,"\n");for(var e="",h=0;h<f.length;h++){var g=f.charCodeAt(h);g<128?e+=String.fromCharCode(g):g>127&&g<2048?(e+=String.fromCharCode(g>>6|192),e+=String.fromCharCode(63&g|128)):(e+=String.fromCharCode(g>>12|224),e+=String.fromCharCode(g>>6&63|128),e+=String.fromCharCode(63&g|128))}return e},_utf8_decode:function(f){for(var e="",h=0,g=c1=c2=0;h<f.length;){g=f.charCodeAt(h),g<128?(e+=String.fromCharCode(g),h++):g>191&&g<224?(c2=f.charCodeAt(h+1),e+=String.fromCharCode((31&g)<<6|63&c2),h+=2):(c2=f.charCodeAt(h+1),c3=f.charCodeAt(h+2),e+=String.fromCharCode((15&g)<<12|(63&c2)<<6|63&c3),h+=3)}return e}};var device=function(){var a=window.navigator.userAgent.toLowerCase();return{iphone:/iphone/.test(a),android:/android/.test(a),winphone:/windows phone/.test(a),qqnews:/qqnews/.test(a),weixin:/micromessenger/.test(a),mqqbrowser:/mqqbrowser/.test(a),qq:/\sqq/.test(a),ucbrowser:a.match(/ucbrowser/)}};var tcGlobalShare=function(){globalConfig.link=globalConfig.link||document.location.href||"";globalConfig.title=globalConfig.title||document.title||"";globalConfig.desc=globalConfig.desc||$("[name=description]").attr("content")||"";globalConfig.img=globalConfig.img||$(".tc-article__content img").length>0&&$(".tc-article__content img")[0].src||"http://www.tecenet.com/about/intro/images/wechat-share-icon.png";$("#sharePopup").html(sharePopupHtml);$("#sharePopup").popup();function d(j,l){var h=[];for(var i in l){h.push(i+"="+l[i])}return j+(j.indexOf("?")!==-1?"&":"?")+h.join("&")}function g(i){var h=d(i,{share_id:"1101685683",url:Base64.encode(globalConfig.link),title:Base64.encode(globalConfig.title),description:Base64.encode(globalConfig.desc),previewimageUrl:Base64.encode(globalConfig.img),image_url:Base64.encode(globalConfig.img)});window.location.href=h}function f(){var h=window.location.href.replace(/&/g,"%26");var i="http://qr.topscan.com/api.php?logo=http://www.tecenet.com/about/intro/images/wechat-share-icon.png&m=10&w=300&text=";return i+h}var c='<div class="wechat-share-guide"><img src="http://www.tecenet.com/file/game/test/wap/images/share-guide-img-2.png" /></div>';var e='<div class="wechat-share-guide"><img src="http://www.tecenet.com/file/game/test/wap/images/share-guide-img-1.png" /></div>';var b='<div class="wechat-share-guide"><img src="http://www.tecenet.com/file/game/test/wap/images/share-guide-img-3.png" /></div>';var a='<div class="wechat-share-guide"><img src="http://www.tecenet.com/file/game/test/wap/images/share-guide-img-4.png" /></div>';$(document).on("touchstart",".wechat-share-guide",function(){$(".wechat-share-guide").remove()});(device().weixin||device().iphone)?$(".share-wechat").show():$(".share-wechat").hide();$(document).on("click",".share-wechat",function(){$.closePopup();if(device().weixin){$("body").append(c)}else{if(device().iphone){$("body").append(e)}}});$(document).on("click",".share-weibo",function(){window.location="http://service.weibo.com/share/share.php?url="+globalConfig.link+"&pic="+globalConfig.img+"&searchPic=false&style=simple&language=zh_cn"});$(document).on("click",".share-QQFriend",function(){if(device().weixin){$.closePopup();$("body").append(b)}else{g("mqqapi://share/to_fri?src_type=web&version=1&file_type=news")}});$(document).on("click",".share-QQZone",function(){if(device().weixin){$.closePopup();$("body").append(a)}else{if(device().iphone){g("mqqapi://share/to_fri?file_type=news&src_type=web&version=1&generalpastboard=1&shareType=1&cflag=1&objectlocation=pasteboard&callback_type=scheme&callback_name=QQ41AF4B2A")}else{g("mqqapi://share/to_qzone?src_type=app&version=1&file_type=news&req_type=1")}}});$(document).on("click",".share-qrcode",function(){var h='<div class="weui-popup__overlay"></div><div class="weui-popup__modal"><div class="toolbar"><div class="toolbar-inner"><a href="javascript:;" class="picker-button close-popup">关闭</a><span class="title">本文二维码</span><a href="javascript:;" class="qrcode-back-button back-button">返回</a></div></div><div class="modal-content qrode-modal-content"><div class="weui-grids"><img class="qrode-modal__img" src='+f()+' /><div class="qrode-modal__text">长按二维码保存图片</div></div></div></div>';$("#sharePopup").html(h)});$(document).on("click",".qrcode-back-button",function(){$("#sharePopup").html(sharePopupHtml)})};$.getScript("//www.tecenet.com/file/game/test/wap/js/clipboard.min.js",function(b,c){if(c==="success"){var a=new Clipboard(".share-copyLink");a.on("success",function(d){$.toast("已复制",1000);d.clearSelection()});a.on("error",function(d){$.toast("复制失败，请手动复制","cancel");d.clearSelection()})}});shareWrapInit();